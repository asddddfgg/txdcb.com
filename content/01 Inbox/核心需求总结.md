
### 2. **智能标签内容收集**

- ✅ 搜索全站标签（如 `#职场` #名言 ）的内容
    
- ✅ 自动去重，避免重复显示
    
- ✅ 排除代码行和模板自身内容
    
- ✅ 保持 Quartz 4 的优雅排版风格
    
- ✅ 万能模板，可搜索全部标签
    

### 3. **静态化输出**

- ✅ 每一个标签生成一个纯静态 markdown 文件，就是全站所有网页中（有特定排除部分）包含这个标签的那句话。保存在E:\quartz\content\02 Notes里
    
- ✅ 可在网页端正常显示（非代码块）
    
- ✅ 支持 GitHub Pages 部署
    
- ✅ 便于分享和远程访问
    

### 4. **便捷的工作流程**

- ✅ 一键运行模板更新所有内容
    
- ✅ 简单的批处理文件操作
    
- ✅ 适合非技术用户使用
    

可参考如下标签，但是必须科学修改，它只是生成一个标签的，你要修改成全站所有标签的，而且是全自动生成，无需手动替换标签的。：



<%*
// ==========================================
// 万能标签搜索器 - 真正的一个模板搜所有标签
// 只需修改 SEARCH_TAG 变量即可
// ==========================================

// 🎯 【只需修改这里】配置你要搜索的标签
const SEARCH_TAG = "#个人";  // 改成 #学习、#成长、#思考 等任何标签

// 🎨 【可选修改】输出文件和标题
const OUTPUT_FILE = `${SEARCH_TAG.replace('#', '')}内容收集.md`; // 自动生成文件名
const COLLECTION_TITLE = `${SEARCH_TAG.replace('#', '')}内容收集`; // 自动生成标题

// 🚫 自动排除的文件（不用改）
const EXCLUDE_FILES = [
    "更新职场金句收集.md", 
    "更新职场金句收集（优化版）.md",
    "更新职场金句收集（优雅版）.md",
    "更新职场金句收集（修复版）.md",
    "万能标签搜索器.md",
    "职场金句收集.md",
    OUTPUT_FILE  // 自动排除输出文件自身
];

// 🕒 记录开始时间
const startTime = new Date();

// 🔍 搜索全站包含指定标签的文件
const allFiles = app.vault.getMarkdownFiles()
    .filter(file => !EXCLUDE_FILES.includes(file.name));

let foundSentences = new Map();
let totalFilesScanned = 0;
let filesWithTag = 0;

// 📖 遍历所有文件，搜索相关句子
for (const file of allFiles) {
    totalFilesScanned++;
    const content = await app.vault.read(file);
    const lines = content.split('\n');
    
    let fileHasTagContent = false;
    
    for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        
        // 基础过滤
        if (!line || line.length < 10) continue;
        if (line.startsWith('#') || line.startsWith('---')) continue;
        
        // 检查是否包含目标标签
        if (line.includes(SEARCH_TAG)) {
            // 跳过统计信息和代码行
            if (line.includes('扫描文件') || line.includes('有效文件') || line.includes('收集内容') || 
                line.includes('运行耗时') || line.includes('const ') || line.includes('let ') ||
                line.includes('await ') || line.includes('tR +=') || line.includes('collectionContent') ||
                line.includes('SEARCH_TAG') || line.includes('OUTPUT_FILE') || line.includes('EXCLUDE_FILES')) {
                continue;
            }
            
            // 清理句子格式
            let cleanSentence = line
                .replace(/^[>-]\s*/, '')
                .replace(/\s+/g, ' ')
                .replace(/`/g, '')
                .trim();
            
            // 确保是真正的文本内容
            if (cleanSentence.length >= 10 && 
                !cleanSentence.startsWith('//') &&
                !cleanSentence.includes('扫描文件') &&
                !cleanSentence.includes('有效文件') &&
                !cleanSentence.includes('收集内容')) {
                
                if (!foundSentences.has(cleanSentence)) {
                    foundSentences.set(cleanSentence, {
                        sourceFile: file.basename,
                        sourcePath: file.path
                    });
                    fileHasTagContent = true;
                }
            }
        }
    }
    
    if (fileHasTagContent) {
        filesWithTag++;
    }
}

// 📊 生成收集内容
let collectionContent = `# ${COLLECTION_TITLE}\n\n`;

// 统计信息
collectionContent += `收集时间：${new Date().toLocaleString()}  |  扫描文件：${totalFilesScanned}  |  包含标签：${filesWithTag}  |  收集内容：${foundSentences.size}\n\n`;

collectionContent += `---\n\n`;

if (foundSentences.size === 0) {
    collectionContent += `> 还没有找到包含 ${SEARCH_TAG} 标签的内容。\n`;
} else {
    // 内容列表
    const sortedSentences = Array.from(foundSentences.entries())
        .sort(([sentenceA], [sentenceB]) => sentenceA.localeCompare(sentenceB));
    
    for (const [sentence, info] of sortedSentences) {
        collectionContent += `${sentence}\n\n`;
        collectionContent += `↳ 来源：[[${info.sourceFile}]]\n\n`;
        collectionContent += `---\n\n`;
    }
}

// 更新说明
collectionContent += `*自动生成 · 最后更新：${new Date().toLocaleString()} · 搜索标签：${SEARCH_TAG}*`;

// 💾 保存到文件
const targetFile = app.vault.getAbstractFileByPath(OUTPUT_FILE);
if (targetFile) {
    await app.vault.modify(targetFile, collectionContent);
} else {
    await app.vault.create(OUTPUT_FILE, collectionContent);
}

// 🎊 结果显示
tR += `## ${SEARCH_TAG} 搜索完成\n\n`;
tR += `- 扫描文件：${totalFilesScanned}\n`;
tR += `- 有效文件：${filesWithTag}\n`;
tR += `- 收集内容：${foundSentences.size}\n`;
tR += `- 运行耗时：${(new Date() - startTime) / 1000}秒\n\n`;

if (foundSentences.size > 0) {
    tR += `**预览：**\n\n`;
    const previewSentences = Array.from(foundSentences.entries()).slice(0, 3);
    previewSentences.forEach(([sentence], index) => {
        if (!sentence.includes('扫描文件') && !sentence.includes('有效文件')) {
            tR += `${sentence}\n\n`;
        }
    });
}

tR += `> 💡 提示：要搜索其他标签，只需修改模板开头的 SEARCH_TAG 变量`;
%>
///////////////////////////
生成的效果 个人内容收集.md
个人内容收集

收集时间：2025/11/30 20:13:03  |  扫描文件：14  |  包含标签：1  |  收集内容：5

---

您的个人品牌就是最终的竞争优势。 #个人发展 #职场策略

↳ 来源：[[职场金句库]]

---

强者自强，从来不是靠对方衰落而强，是自身实力上去了那才是强。 #个人成长 #竞争哲学

↳ 来源：[[职场金句库]]

---

缺乏前进的不懈勇气。 #个人成长 #心态调整

↳ 来源：[[职场金句库]]

---

停留在“低生态位” #社会分层 #个人发展

↳ 来源：[[职场金句库]]

---

未能平衡野心与自律的人 #个人成长 #成功学

↳ 来源：[[职场金句库]]

---

*自动生成 · 最后更新：2025/11/30 20:13:03 · 搜索标签：#个人*